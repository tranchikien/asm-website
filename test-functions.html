<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Functions</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background: #1a1a1a; color: white; padding: 20px; }
        .test-section { margin: 20px 0; padding: 20px; background: #333; border-radius: 10px; }
        .btn-orange { background: #ff6b35; border-color: #ff6b35; color: white; }
        .btn-orange:hover { background: #e55a2b; border-color: #e55a2b; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <h2>üß™ Test Functions</h2>
        
        <div class="test-section">
            <h4>1. Test Individual Functions</h4>
            <button class="btn btn-orange me-2" onclick="testShowProfilePage()">Test Profile</button>
            <button class="btn btn-orange me-2" onclick="testShowWishlist()">Test Wishlist</button>
            <button class="btn btn-orange me-2" onclick="testShowOrderHistory()">Test Orders</button>
            <button class="btn btn-orange me-2" onclick="testOpenAdminPanel()">Test Admin Panel</button>
            <button class="btn btn-orange me-2" onclick="testLogout()">Test Logout</button>
        </div>

        <div class="test-section">
            <h4>2. Test Results</h4>
            <div id="test-results" class="alert alert-info">
                Click buttons to test functions...
            </div>
        </div>

        <div class="test-section">
            <h4>3. Load Scripts</h4>
            <button class="btn btn-primary" onclick="loadScripts()">Load All Scripts</button>
            <div id="script-status" class="mt-3"></div>
        </div>

        <div class="test-section">
            <h4>4. Debug Info</h4>
            <button class="btn btn-info" onclick="showDebugInfo()">Show Debug Info</button>
            <div id="debug-info" class="mt-3"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        let scriptsLoaded = false;

        function showResult(message, type = 'info') {
            const results = document.getElementById('test-results');
            results.innerHTML = `<strong>${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : '‚ÑπÔ∏è'}</strong> ${message}`;
            results.className = `alert alert-${type}`;
            console.log(`üß™ ${message}`);
        }

        function testShowProfilePage() {
            if (!scriptsLoaded) {
                showResult('Scripts not loaded yet', 'error');
                return;
            }
            
            try {
                if (typeof showProfilePage === 'function') {
                    showProfilePage();
                    showResult('showProfilePage() called successfully', 'success');
                } else {
                    showResult('showProfilePage function not found', 'error');
                }
            } catch (error) {
                showResult(`Error calling showProfilePage: ${error.message}`, 'error');
            }
        }

        function testShowWishlist() {
            if (!scriptsLoaded) {
                showResult('Scripts not loaded yet', 'error');
                return;
            }
            
            try {
                if (typeof showWishlist === 'function') {
                    showWishlist();
                    showResult('showWishlist() called successfully', 'success');
                } else {
                    showResult('showWishlist function not found', 'error');
                }
            } catch (error) {
                showResult(`Error calling showWishlist: ${error.message}`, 'error');
            }
        }

        function testShowOrderHistory() {
            if (!scriptsLoaded) {
                showResult('Scripts not loaded yet', 'error');
                return;
            }
            
            try {
                if (typeof showOrderHistory === 'function') {
                    showOrderHistory();
                    showResult('showOrderHistory() called successfully', 'success');
                } else {
                    showResult('showOrderHistory function not found', 'error');
                }
            } catch (error) {
                showResult(`Error calling showOrderHistory: ${error.message}`, 'error');
            }
        }

        function testOpenAdminPanel() {
            if (!scriptsLoaded) {
                showResult('Scripts not loaded yet', 'error');
                return;
            }
            
            try {
                if (typeof openAdminPanel === 'function') {
                    openAdminPanel();
                    showResult('openAdminPanel() called successfully', 'success');
                } else {
                    showResult('openAdminPanel function not found', 'error');
                }
            } catch (error) {
                showResult(`Error calling openAdminPanel: ${error.message}`, 'error');
            }
        }

        function testLogout() {
            if (!scriptsLoaded) {
                showResult('Scripts not loaded yet', 'error');
                return;
            }
            
            try {
                if (typeof logout === 'function') {
                    logout();
                    showResult('logout() called successfully', 'success');
                } else {
                    showResult('logout function not found', 'error');
                }
            } catch (error) {
                showResult(`Error calling logout: ${error.message}`, 'error');
            }
        }

        function loadScripts() {
            const status = document.getElementById('script-status');
            status.innerHTML = '<div class="alert alert-warning">Loading scripts...</div>';
            
            const scripts = [
                'js/config.js',
                'js/auth.js', 
                'js/main.js',
                'js/games.js',
                'js/cart.js',
                'js/utils.js'
            ];

            let loadedCount = 0;
            scripts.forEach((src, index) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = () => {
                    loadedCount++;
                    console.log(`‚úÖ Loaded: ${src}`);
                    if (loadedCount === scripts.length) {
                        scriptsLoaded = true;
                        status.innerHTML = '<div class="alert alert-success">‚úÖ All scripts loaded successfully!</div>';
                        showDebugInfo();
                    }
                };
                script.onerror = () => {
                    console.error(`‚ùå Failed to load: ${src}`);
                    status.innerHTML = `<div class="alert alert-danger">‚ùå Failed to load: ${src}</div>`;
                };
                document.head.appendChild(script);
            });
        }

        function showDebugInfo() {
            const debugInfo = document.getElementById('debug-info');
            const functions = [
                'showProfilePage',
                'showWishlist', 
                'showOrderHistory',
                'openAdminPanel',
                'logout',
                'updateUserDropdown',
                'getCurrentUser',
                'isAdmin'
            ];

            let html = '<h5>Function Availability:</h5>';
            functions.forEach(funcName => {
                const exists = typeof window[funcName] === 'function';
                const status = exists ? '‚úÖ' : '‚ùå';
                const color = exists ? 'text-success' : 'text-danger';
                html += `<div class="${color}">${status} ${funcName}: ${exists ? 'Available' : 'Missing'}</div>`;
            });

            // Check localStorage
            const user = localStorage.getItem('user');
            const token = localStorage.getItem('authToken');
            html += '<h5 class="mt-3">LocalStorage:</h5>';
            html += `<div class="text-info">User: ${user ? 'Present' : 'Missing'}</div>`;
            html += `<div class="text-info">Token: ${token ? 'Present' : 'Missing'}</div>`;

            if (user) {
                try {
                    const userObj = JSON.parse(user);
                    html += `<div class="text-info">User Email: ${userObj.email || 'N/A'}</div>`;
                    html += `<div class="text-info">Is Admin: ${userObj.isAdmin ? 'Yes' : 'No'}</div>`;
                } catch (e) {
                    html += `<div class="text-danger">Error parsing user data</div>`;
                }
            }

            debugInfo.innerHTML = html;
        }

        // Auto load scripts on page load
        window.onload = function() {
            console.log('üß™ Function Test Page Loaded');
            loadScripts();
        };
    </script>
</body>
</html> 