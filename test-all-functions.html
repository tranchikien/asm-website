<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIENSTORE - Function Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
</head>
<body class="bg-dark text-light">
    <div class="container py-5">
        <h1 class="text-center mb-5">
            <i class="fas fa-gamepad text-orange me-3"></i>
            KIENSTORE Function Test
        </h1>

        <div class="row">
            <div class="col-md-6">
                <div class="card bg-dark border-secondary mb-4">
                    <div class="card-header">
                        <h5><i class="fas fa-user me-2"></i>Authentication Test</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Admin Login Test</label>
                            <div class="d-flex gap-2">
                                <button class="btn btn-orange" onclick="testAdminLogin()">
                                    <i class="fas fa-sign-in-alt me-2"></i>Test Admin Login
                                </button>
                                <button class="btn btn-outline-info" onclick="testUserLogin()">
                                    <i class="fas fa-user me-2"></i>Test User Login
                                </button>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Registration Test</label>
                            <button class="btn btn-success" onclick="testRegistration()">
                                <i class="fas fa-user-plus me-2"></i>Test Registration
                            </button>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Logout Test</label>
                            <button class="btn btn-danger" onclick="testLogout()">
                                <i class="fas fa-sign-out-alt me-2"></i>Test Logout
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card bg-dark border-secondary mb-4">
                    <div class="card-header">
                        <h5><i class="fas fa-shopping-cart me-2"></i>Cart & Order Test</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Cart Functions</label>
                            <div class="d-flex gap-2 mb-2">
                                <button class="btn btn-sm btn-orange" onclick="testAddToCart()">
                                    <i class="fas fa-cart-plus me-1"></i>Add to Cart
                                </button>
                                <button class="btn btn-sm btn-outline-info" onclick="testViewCart()">
                                    <i class="fas fa-eye me-1"></i>View Cart
                                </button>
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-sm btn-success" onclick="testCheckout()">
                                    <i class="fas fa-credit-card me-1"></i>Test Checkout
                                </button>
                                <button class="btn btn-sm btn-outline-warning" onclick="testOrderHistory()">
                                    <i class="fas fa-history me-1"></i>Order History
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="card bg-dark border-secondary mb-4">
                    <div class="card-header">
                        <h5><i class="fas fa-heart me-2"></i>Wishlist Test</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Wishlist Functions</label>
                            <div class="d-flex gap-2 mb-2">
                                <button class="btn btn-sm btn-danger" onclick="testAddToWishlist()">
                                    <i class="fas fa-heart me-1"></i>Add to Wishlist
                                </button>
                                <button class="btn btn-sm btn-outline-danger" onclick="testViewWishlist()">
                                    <i class="fas fa-eye me-1"></i>View Wishlist
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card bg-dark border-secondary mb-4">
                    <div class="card-header">
                        <h5><i class="fas fa-user-cog me-2"></i>Profile Test</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Profile Functions</label>
                            <div class="d-flex gap-2">
                                <button class="btn btn-sm btn-info" onclick="testLoadProfile()">
                                    <i class="fas fa-user me-1"></i>Load Profile
                                </button>
                                <button class="btn btn-sm btn-outline-info" onclick="testUpdateProfile()">
                                    <i class="fas fa-edit me-1"></i>Update Profile
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="card bg-dark border-secondary mb-4">
                    <div class="card-header">
                        <h5><i class="fas fa-shield-alt me-2"></i>Admin Panel Test</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Admin Functions</label>
                            <div class="d-flex gap-2 mb-2">
                                <button class="btn btn-sm btn-warning" onclick="testAdminPanel()">
                                    <i class="fas fa-cog me-1"></i>Open Admin Panel
                                </button>
                                <button class="btn btn-sm btn-outline-warning" onclick="testAddProduct()">
                                    <i class="fas fa-plus me-1"></i>Add Product
                                </button>
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-sm btn-outline-info" onclick="testAdminOrders()">
                                    <i class="fas fa-list me-1"></i>View Orders
                                </button>
                                <button class="btn btn-sm btn-outline-success" onclick="testAdminUsers()">
                                    <i class="fas fa-users me-1"></i>View Users
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card bg-dark border-secondary mb-4">
                    <div class="card-header">
                        <h5><i class="fas fa-gamepad me-2"></i>Games Test</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Games Functions</label>
                            <div class="d-flex gap-2 mb-2">
                                <button class="btn btn-sm btn-primary" onclick="testShowAllGames()">
                                    <i class="fas fa-list me-1"></i>Show All Games
                                </button>
                                <button class="btn btn-sm btn-outline-primary" onclick="testShowSaleGames()">
                                    <i class="fas fa-tags me-1"></i>Show Sale Games
                                </button>
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-sm btn-outline-success" onclick="testSearchGames()">
                                    <i class="fas fa-search me-1"></i>Search Games
                                </button>
                                <button class="btn btn-sm btn-outline-warning" onclick="testGameDetail()">
                                    <i class="fas fa-eye me-1"></i>Game Detail
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="card bg-dark border-secondary">
                    <div class="card-header">
                        <h5><i class="fas fa-terminal me-2"></i>Test Results</h5>
                    </div>
                    <div class="card-body">
                        <div id="test-results" class="bg-darker p-3 rounded" style="min-height: 200px; max-height: 400px; overflow-y: auto;">
                            <p class="text-muted">Test results will appear here...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Test Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/games.js"></script>
    <script src="js/main.js"></script>
    <script src="js/utils.js"></script>

    <script>
        // Test Functions
        function logTest(message, type = 'info') {
            const results = document.getElementById('test-results');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? 'text-danger' : type === 'success' ? 'text-success' : 'text-info';
            
            results.innerHTML += `
                <div class="${color} mb-1">
                    <small>[${timestamp}]</small> ${message}
                </div>
            `;
            results.scrollTop = results.scrollHeight;
        }

        // Authentication Tests
        async function testAdminLogin() {
            logTest('üîê Testing Admin Login...');
            try {
                const result = await authenticateUser('admin@kienstore.com', 'admin123');
                if (result.success) {
                    logTest('‚úÖ Admin login successful!', 'success');
                    logTest(`User: ${result.user.fullname}, Admin: ${result.user.isAdmin}`, 'success');
                } else {
                    logTest(`‚ùå Admin login failed: ${result.message}`, 'error');
                }
            } catch (error) {
                logTest(`‚ùå Admin login error: ${error.message}`, 'error');
            }
        }

        async function testUserLogin() {
            logTest('üîê Testing User Login...');
            try {
                const result = await authenticateUser('user@test.com', 'password123');
                if (result.success) {
                    logTest('‚úÖ User login successful!', 'success');
                } else {
                    logTest(`‚ùå User login failed: ${result.message}`, 'error');
                }
            } catch (error) {
                logTest(`‚ùå User login error: ${error.message}`, 'error');
            }
        }

        async function testRegistration() {
            logTest('üìù Testing Registration...');
            try {
                const userData = {
                    email: 'test@example.com',
                    password: 'Test123!',
                    fullname: 'Test User',
                    phone: '0123456789',
                    address: 'Test Address',
                    birthday: '1990-01-01',
                    location: 'Test City'
                };
                
                const result = await registerUser(userData);
                if (result.success) {
                    logTest('‚úÖ Registration successful!', 'success');
                } else {
                    logTest(`‚ùå Registration failed: ${result.message}`, 'error');
                }
            } catch (error) {
                logTest(`‚ùå Registration error: ${error.message}`, 'error');
            }
        }

        function testLogout() {
            logTest('üö™ Testing Logout...');
            try {
                logout();
                logTest('‚úÖ Logout successful!', 'success');
            } catch (error) {
                logTest(`‚ùå Logout error: ${error.message}`, 'error');
            }
        }

        // Cart Tests
        function testAddToCart() {
            logTest('üõí Testing Add to Cart...');
            try {
                const testGame = {
                    id: 1,
                    name: 'Test Game',
                    price: 100000,
                    image: 'images/test.jpg'
                };
                addToCart(testGame);
                logTest('‚úÖ Add to cart successful!', 'success');
            } catch (error) {
                logTest(`‚ùå Add to cart error: ${error.message}`, 'error');
            }
        }

        function testViewCart() {
            logTest('üëÅÔ∏è Testing View Cart...');
            try {
                const cart = JSON.parse(localStorage.getItem('cart') || '[]');
                logTest(`Cart has ${cart.length} items`, 'info');
                cart.forEach(item => {
                    logTest(`- ${item.name}: ${item.price} VNƒê`, 'info');
                });
            } catch (error) {
                logTest(`‚ùå View cart error: ${error.message}`, 'error');
            }
        }

        function testCheckout() {
            logTest('üí≥ Testing Checkout...');
            try {
                handleCheckout();
                logTest('‚úÖ Checkout function called!', 'success');
            } catch (error) {
                logTest(`‚ùå Checkout error: ${error.message}`, 'error');
            }
        }

        function testOrderHistory() {
            logTest('üìã Testing Order History...');
            try {
                loadOrderHistory();
                logTest('‚úÖ Order history loaded!', 'success');
            } catch (error) {
                logTest(`‚ùå Order history error: ${error.message}`, 'error');
            }
        }

        // Wishlist Tests
        function testAddToWishlist() {
            logTest('‚ù§Ô∏è Testing Add to Wishlist...');
            try {
                const testGame = {
                    id: 1,
                    name: 'Test Game',
                    price: 100000,
                    image: 'images/test.jpg'
                };
                addToWishlist(testGame);
                logTest('‚úÖ Add to wishlist successful!', 'success');
            } catch (error) {
                logTest(`‚ùå Add to wishlist error: ${error.message}`, 'error');
            }
        }

        function testViewWishlist() {
            logTest('üëÅÔ∏è Testing View Wishlist...');
            try {
                const wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');
                logTest(`Wishlist has ${wishlist.length} items`, 'info');
                wishlist.forEach(item => {
                    logTest(`- ${item.name}: ${item.price} VNƒê`, 'info');
                });
            } catch (error) {
                logTest(`‚ùå View wishlist error: ${error.message}`, 'error');
            }
        }

        // Profile Tests
        function testLoadProfile() {
            logTest('üë§ Testing Load Profile...');
            try {
                loadUserProfile();
                logTest('‚úÖ Load profile function called!', 'success');
            } catch (error) {
                logTest(`‚ùå Load profile error: ${error.message}`, 'error');
            }
        }

        function testUpdateProfile() {
            logTest('‚úèÔ∏è Testing Update Profile...');
            try {
                updateProfile();
                logTest('‚úÖ Update profile function called!', 'success');
            } catch (error) {
                logTest(`‚ùå Update profile error: ${error.message}`, 'error');
            }
        }

        // Admin Tests
        function testAdminPanel() {
            logTest('‚öôÔ∏è Testing Admin Panel...');
            try {
                openAdminPanel();
                logTest('‚úÖ Admin panel opened!', 'success');
            } catch (error) {
                logTest(`‚ùå Admin panel error: ${error.message}`, 'error');
            }
        }

        function testAddProduct() {
            logTest('‚ûï Testing Add Product...');
            try {
                showAddProductModal();
                logTest('‚úÖ Add product modal opened!', 'success');
            } catch (error) {
                logTest(`‚ùå Add product error: ${error.message}`, 'error');
            }
        }

        function testAdminOrders() {
            logTest('üìã Testing Admin Orders...');
            try {
                showAdminOrders();
                logTest('‚úÖ Admin orders function called!', 'success');
            } catch (error) {
                logTest(`‚ùå Admin orders error: ${error.message}`, 'error');
            }
        }

        function testAdminUsers() {
            logTest('üë• Testing Admin Users...');
            try {
                showAdminUsers();
                logTest('‚úÖ Admin users function called!', 'success');
            } catch (error) {
                logTest(`‚ùå Admin users error: ${error.message}`, 'error');
            }
        }

        // Games Tests
        function testShowAllGames() {
            logTest('üéÆ Testing Show All Games...');
            try {
                showAllGames();
                logTest('‚úÖ Show all games function called!', 'success');
            } catch (error) {
                logTest(`‚ùå Show all games error: ${error.message}`, 'error');
            }
        }

        function testShowSaleGames() {
            logTest('üè∑Ô∏è Testing Show Sale Games...');
            try {
                showSaleGames();
                logTest('‚úÖ Show sale games function called!', 'success');
            } catch (error) {
                logTest(`‚ùå Show sale games error: ${error.message}`, 'error');
            }
        }

        function testSearchGames() {
            logTest('üîç Testing Search Games...');
            try {
                searchGames();
                logTest('‚úÖ Search games function called!', 'success');
            } catch (error) {
                logTest(`‚ùå Search games error: ${error.message}`, 'error');
            }
        }

        function testGameDetail() {
            logTest('üëÅÔ∏è Testing Game Detail...');
            try {
                showProductDetailPage(1);
                logTest('‚úÖ Game detail function called!', 'success');
            } catch (error) {
                logTest(`‚ùå Game detail error: ${error.message}`, 'error');
            }
        }

        // Initialize test page
        document.addEventListener('DOMContentLoaded', function() {
            logTest('üöÄ Test page initialized!', 'success');
            logTest(`API Base URL: ${API_BASE_URL}`, 'info');
            logTest(`Games Data Available: ${typeof gamesData !== 'undefined' ? 'Yes' : 'No'}`, 'info');
            if (typeof gamesData !== 'undefined') {
                logTest(`Games Count: ${gamesData.length}`, 'info');
            }
        });
    </script>
</body>
</html> 